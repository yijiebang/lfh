(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-586462fa"],{"09fc":function(e,t,a){},"0e25":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-stepper",{attrs:{value:e.currentStep},on:{input:e.updateStep}},[a("v-stepper-header",[e._l(e.steps,function(t,n){return[a("v-stepper-step",{key:"step-header-"+n,attrs:{editable:e.currentStep>n+1&&!e.previewed,step:n+1}},[e._v(e._s(t))]),e._v(" "),n<e.steps.length-1?a("v-divider",{key:"header-divider-"+n}):e._e()]})],2),e._v(" "),e._l(e.components,function(t,n){return a("v-stepper-items",{key:n},[a("v-stepper-content",{key:n+"-content",attrs:{step:n+1}},[a(t,{tag:"component",on:{pre:function(t){return e.preHandler(n+1)},next:function(t){return e.nextHandler(n+1)}}})],1)],1)})],2)},r=[],s=a("db72"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("add-info-sales",{ref:"infoSales",attrs:{info:e.salesInfo}}),e._v(" "),a("v-container",{attrs:{fluid:""}},[a("v-layout",[a("v-flex",{attrs:{xs12:"",md4:""}},[a("add-info-client",{ref:"infoClient1",staticClass:"blueClient",attrs:{title:"擬被保人",info:e.client1Info}})],1),e._v(" "),a("v-flex",{staticClass:"mx-4",attrs:{xs12:"",md4:""}},[a("add-info-client",{ref:"infoClient2",staticClass:"greenClient",attrs:{title:"次擬被保人",valite:!1,info:e.client2Info}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md4:""}},[a("add-info-client",{ref:"infoClient3",staticClass:"orangeClient",attrs:{title:"付款者豁免保费专用",valite:!1,"pay-input":e.payInput,info:e.client3Info}})],1)],1),e._v(" "),a("v-layout",{staticClass:"mt-4",attrs:{"justify-space-between":""}},[a("v-btn",{staticStyle:{background:"#52a5b5",color:"#fff"},on:{click:function(t){return e.goBack()}}},[a("v-icon",[e._v("arrow_back")]),e._v("返回\n      ")],1),e._v(" "),a("v-btn",{staticStyle:{background:"#52a5b5",color:"#fff"},on:{click:e.next}},[e._v("\n        下一步\n        "),a("v-icon",[e._v("arrow_forward")])],1)],1)],1)],1)},o=[],l=(a("7f7f"),a("7618")),u=(a("96cf"),a("3b8d")),c=a("2f62");a("28a5"),a("6b54"),a("a481"),a("c5f6");function d(e){if(/[^0-9\.]/.test(e))return"invalid value";e=e.replace(/^(\d*)$/,"$1."),e=(e+"00").replace(/(\d*\.\d\d)\d*/,"$1"),e=e.replace(".",",");var t=/(\d)(\d{3},)/;while(t.test(e))e=e.replace(t,"$1,$2");return e=e.replace(/,(\d\d)$/,".$1"),e.replace(/^\./,"0.")}function m(e){var t=[],a=0;e=(e||0).toString().split("");for(var n=e.length-1;n>=0;n--)a++,t.unshift(e[n]),a%3||0===n||t.unshift(",");return t.join("")}function p(e){var t=e.indexOf("-");return e=e.substring(t+1,e.length),e}function f(e){history.pushState(null,null,e),window.addEventListener("popstate",function(){history.pushState(null,null,e)})}var h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-form",{ref:"formInfoSales"},[a("v-container",{attrs:{fluid:""}},[a("v-layout",[a("v-flex",{attrs:{xs12:"",md3:""}},[a("v-text-field",{attrs:{label:"建議書編號",disabled:""},model:{value:e.formData.proposalId,callback:function(t){e.$set(e.formData,"proposalId",t)},expression:"formData.proposalId"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md3:""}},[a("v-text-field",{attrs:{label:"日期",disabled:""},model:{value:e.formData.date,callback:function(t){e.$set(e.formData,"date",t)},expression:"formData.date"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md3:""}},[a("v-text-field",{attrs:{label:"參考",disabled:e.disabled},model:{value:e.formData.reference,callback:function(t){e.$set(e.formData,"reference",t)},expression:"formData.reference"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md3:""}},[a("v-text-field",{attrs:{label:"營業員註冊編號",disabled:e.disabled,suffix:" /ANG"},model:{value:e.formData.salesId,callback:function(t){e.$set(e.formData,"salesId",t)},expression:"formData.salesId"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md3:""}},[a("v-text-field",{attrs:{label:"營業員",disabled:e.disabled},model:{value:e.formData.salesName,callback:function(t){e.$set(e.formData,"salesName",t)},expression:"formData.salesName"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md3:""}},[a("v-text-field",{attrs:{label:"聯絡電話",disabled:e.disabled},model:{value:e.formData.tel,callback:function(t){e.$set(e.formData,"tel",t)},expression:"formData.tel"}})],1)],1)],1)],1)},v=[],b={name:"ProposalAddInfoSales",props:{disabled:{type:Boolean,default:!1},info:{type:Object,default:function(){return{}}}},data:function(){return{formData:{proposalId:"",date:"",reference:"",salesId:"",salesName:"",tel:""},rules:{required:function(e){return!!e||"請輸入"}}}},watch:{info:function(e){this.formData=Object(s["a"])({},this.info),this.formData.date=this.formatterDate(new Date)}},created:function(){this.formData=Object(s["a"])({},this.info),this.formData.date=this.formatterDate(new Date)},methods:{formatterDate:function(e){var t=e.getFullYear(),a=e.getMonth()+1;a=a<10?"0"+a:a;var n=e.getDate();return n=n<10?"0"+n:n,a+"/"+n+"/"+t},getData:function(){return Object(s["a"])({},this.formData)}}},y=b,g=a("2877"),x=a("6544"),P=a.n(x),D=a("a523"),I=a("0e8f"),w=a("4bd4"),_=a("a722"),k=a("2677"),S=Object(g["a"])(y,h,v,!1,null,"6ad1e839",null),C=S.exports;P()(S,{VContainer:D["a"],VFlex:I["a"],VForm:w["a"],VLayout:_["a"],VTextField:k["a"]});var q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",{class:e.color},[a("v-icon",{staticClass:"mr-2",attrs:{color:"white"}},[e._v("\n      person\n    ")]),e._v(" "),a("span",{staticClass:"subheading white--text"},[e._v(e._s(e.title))])],1),e._v(" "),a("v-card-text",[a("v-form",[a("v-text-field",{attrs:{disabled:e.clientDisabled||e.payInput,"error-messages":e.nameErrors,counter:100,label:"姓名"},model:{value:e.$v.formData.name.$model,callback:function(t){e.$set(e.$v.formData.name,"$model","string"===typeof t?t.trim():t)},expression:"$v.formData.name.$model"}}),e._v(" "),a("v-text-field",{attrs:{disabled:e.clientDisabled,"error-messages":e.ageErrors,label:"年齡"},model:{value:e.$v.formData.age.$model,callback:function(t){e.$set(e.$v.formData.age,"$model",e._n(t))},expression:"$v.formData.age.$model"}}),e._v(" "),a("v-radio-group",{staticClass:"mt-1",attrs:{disabled:e.clientDisabled,row:""},model:{value:e.formData.gender,callback:function(t){e.$set(e.formData,"gender",t)},expression:"formData.gender"}},e._l(e.genderItems,function(t){return a("v-radio",e._b({key:"gender-"+t.value},"v-radio",t,!1))}),1),e._v(" "),a("v-radio-group",{staticClass:"mt-1",attrs:{disabled:e.clientDisabled,row:""},model:{value:e.formData.isSmoker,callback:function(t){e.$set(e.formData,"isSmoker",t)},expression:"formData.isSmoker"}},e._l(e.smokerItems,function(t){return a("v-radio",e._b({key:"smoker-"+t.value},"v-radio",t,!1))}),1)],1)],1),e._v(" "),e.actions?a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:e.color},on:{click:function(t){return e.$emit("cancel")}}},[e._v("確定")])],1):e._e()],1)},$=[],T=a("1dce"),R=a("b5ae"),N=(a("7514"),[{label:"男",value:"M"},{label:"女",value:"F"}]);function O(e){var t=N.find(function(t){return t.value===e});return t?t.label:""}var E=[{label:"吸煙者",value:"Y"},{label:"非吸煙者",value:"N"}];function A(e){var t=E.find(function(t){return t.value===e});return t?t.label:""}var j={name:"ProposalAddInfoClient",mixins:[T["validationMixin"]],props:{title:{type:String,default:"Title"},color:{type:String,default:""},actions:{type:Boolean,default:!1},info:{type:Object,default:function(){return{}}},valite:{type:Boolean,default:!0},clientDisabled:{type:Boolean,default:!1},payInput:{type:Boolean}},validations:{formData:{name:{required:R["required"],maxLength:Object(R["maxLength"])(100)},age:{required:R["required"],between:Object(R["between"])(0,70)}}},data:function(){return{formData:{name:"",age:"",gender:"",isSmoker:""},smokerItems:E,genderItems:N}},computed:{nameErrors:function(){var e=this.$v.formData.name;if(!e.maxLength)return"請輸入合法的名字";if(this.valite){if(!e.$dirty)return"";if(!e.required)return"請輸入名字"}return""},ageErrors:function(){var e=this.$v.formData.age;if(!e.between)return"請輸入合法的年齡";if(this.valite){if(!e.$dirty)return"";if(!e.required)return"請輸入年齡"}return""}},watch:{info:function(e){this.formData=Object(s["a"])({},this.formData,{},this.info)}},created:function(){this.formData=Object(s["a"])({},this.formData,{},this.info)},methods:{getData:function(){var e=this.$v;if(e.$touch(),!e.$error)return Object(s["a"])({},this.formData)},getData2:function(){var e=this.$v;return e.$touch(),Object(s["a"])({},this.formData)},reset:function(){console.log(Object(s["a"])({},this.$v)),this.$v.$reset()}}},V=j,L=a("8336"),F=a("b0af"),B=a("99d9"),M=a("12b2"),Y=a("132d"),W=a("67b6"),U=a("43a6"),G=a("9910"),H=Object(g["a"])(V,q,$,!1,null,null,null),J=H.exports;P()(H,{VBtn:L["a"],VCard:F["a"],VCardActions:B["a"],VCardText:B["b"],VCardTitle:M["a"],VForm:w["a"],VIcon:Y["a"],VRadio:W["a"],VRadioGroup:U["a"],VSpacer:G["a"],VTextField:k["a"]});var Q={name:"ProposalAddInfo",components:{AddInfoSales:C,AddInfoClient:J},data:function(){return{formData:{name:"",age:"",gender:"",isSmoker:""},payInput:!0,years:""}},computed:Object(s["a"])({},Object(c["c"])({user:function(e){return e.user.info},currentStep:function(e){return e.proposal.currentStep},salesInfo:function(e){return e.proposal.salesInfo},client1Info:function(e){return e.proposal.client1Info},client2Info:function(e){return e.proposal.client2Info},client3Info:function(e){return e.proposal.client3Info},plan:function(e){return e.proposal.plan},previewed:function(e){return e.proposal.previewed}})),watch:{currentStep:function(e){1===e&&(this.previewed?(this.createNewOrder(),this["proposal/UPDATE_PREVIEWED"](!1)):this.getDetail())}},beforeCreate:function(){f(document.URL)},created:function(){var e=this.$route.query.quotNo;null!=e&&this.getDetail()},methods:Object(s["a"])({},Object(c["b"])(["proposal/SET_INFO","proposal/RESET_STATE","proposal/SET_PLAN","proposal/UPDATE_PREVIEWED"]),{createNewOrder:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,a,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={quotNo:this.salesInfo.proposalId},e.next=3,this.$api.editInsured(t);case 3:a=e.sent,a.body&&"object"===Object(l["a"])(a.body)&&(n=Object(s["a"])({},this.salesInfo,{proposalId:a.body.quotNo}),this["proposal/SET_INFO"]({salesInfo:n}));case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),next:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s,i,o,l,u,c,d,m,p,f,h,v,b,y;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$refs,a=t.infoSales.getData(),n=t.infoClient1.getData(),r=t.infoClient2.getData(),s=t.infoClient3.getData2(),n){e.next=7;break}return e.abrupt("return",console.warn("表單數據未填寫"));case 7:return void 0===r&&(r=this.formData),void 0===s&&(s=this.formData),this.client1Info.age===n.age&&this.client1Info.gender===n.gender&&this.client1Info.isSmoker===n.isSmoker||this["proposal/RESET_STATE"]({plan:this.$store.state.plan}),i=a.date,o=a.proposalId,l=a.reference,u=a.salesId,c=a.salesName,d=a.tel,m=n.name,p=n.age,f=n.gender,h=n.isSmoker,v={quotNo:o,quotDate:i,quotRefno:l,quotAgtId:u,quotAgtName:c,quotAgtTel:d,quotYears:this.years,quotFinsuredName:m,quotFinsuredAge:p,quotFinsuredGender:f,quotFinsuredSmoker:h,quotSinsuredName:r.name,quotSinsuredAge:r.age,quotSinsuredGender:r.gender,quotSinsuredSmoker:r.isSmoker,quotWinsuredName:s.name,quotWinsuredAge:s.age,quotWinsuredGender:s.gender,quotWinsuredSmoker:s.isSmoker},e.next=15,this.$api.insert(v);case 15:b=e.sent,y=b.body.quotNo,a.proposalId=y,this["proposal/SET_INFO"]({salesInfo:a,client1Info:n,client2Info:r,client3Info:s}),this.$emit("next");case 20:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),goBack:function(){""!==this.user?this.$router.push("/"):this.$router.push("/login")},getDetail:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.showquotdetail({quotNo:this.$route.query.quotNo});case 2:t=e.sent,a=t.body.quotDetail,this.years=a.quotYears,n={proposalId:a.quotNo,date:a.quotDate,reference:a.quotRefno,salesId:a.quotAgtId,salesName:a.quotAgtName,tel:a.quotAgtTel},r={name:a.quotFinsuredName,age:a.quotFinsuredAge,gender:a.quotFinsuredGender,isSmoker:a.quotFinsuredSmoker},s={name:a.quotSinsuredName,age:a.quotSinsuredAge,gender:a.quotSinsuredGender,isSmoker:a.quotSinsuredSmoker},i={name:a.quotWinsuredName,age:a.quotWinsuredAge,gender:a.quotWinsuredGender,isSmoker:a.quotWinsuredSmoker},void 0!==this.$route.query.quotNo&&this["proposal/SET_INFO"]({salesInfo:n,client1Info:r,client2Info:s,client3Info:i});case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()})},z=Q,K=(a("0fb7"),Object(g["a"])(z,i,o,!1,null,null,null)),X=K.exports;P()(K,{VBtn:L["a"],VContainer:D["a"],VFlex:I["a"],VIcon:Y["a"],VLayout:_["a"]});var Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("add-info-sales",{ref:"infoSales",attrs:{info:e.salesInfo,disabled:""}}),e._v(" "),a("v-container",{staticClass:"py-0 px-3",attrs:{fluid:""}},[a("v-layout",[a("v-flex",{attrs:{xs12:"",md4:""}},[a("v-text-field",{attrs:{value:e.client1,label:"擬被保人",disabled:""}})],1)],1)],1),e._v(" "),a("v-divider"),e._v(" "),a("add-plan-form",{ref:"planForm"}),e._v(" "),a("v-layout",{staticClass:"mt-4",attrs:{"justify-space-between":""}},[a("v-btn",{staticStyle:{background:"#52a5b5",color:"#fff"},on:{click:e.pre}},[a("v-icon",[e._v("arrow_back")]),e._v("上一步")],1),e._v(" "),a("v-btn",{staticStyle:{background:"#52a5b5",color:"#fff"},on:{click:e.next}},[e._v("下一步"),a("v-icon",[e._v("arrow_forward")])],1)],1)],1)},ee=[],te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-form",[a("v-container",{attrs:{fluid:""}},[a("v-layout",{attrs:{wrap:""}},[a("v-flex",{attrs:{xs12:"",md4:""}},[a("v-select",{ref:"planSelect",attrs:{"error-messages":e.planErrors,label:"基本計劃",items:e.planItems},on:{change:e.updOtherSelect},model:{value:e.$v.formData.plan.$model,callback:function(t){e.$set(e.$v.formData.plan,"$model","string"===typeof t?t.trim():t)},expression:"$v.formData.plan.$model"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md2:""}},[a("v-select",{attrs:{"error-messages":e.yearErrors,label:"年期",disabled:e.isDisable,items:e.yearItems},on:{change:e.updYearSelect},model:{value:e.$v.formData.year.$model,callback:function(t){e.$set(e.$v.formData.year,"$model","string"===typeof t?t.trim():t)},expression:"$v.formData.year.$model"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md2:""}},[a("v-select",{attrs:{"error-messages":e.moneyErrors,label:"貨幣",items:e.moneyItems},model:{value:e.$v.formData.money.$model,callback:function(t){e.$set(e.$v.formData.money,"$model","string"===typeof t?t.trim():t)},expression:"$v.formData.money.$model"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md2:""}},[a("v-select",{attrs:{label:"繳費辦法",items:e.payTypeItems},model:{value:e.formData.payType,callback:function(t){e.$set(e.formData,"payType",t)},expression:"formData.payType"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md2:""}},[a("v-select",{attrs:{label:"紅利選擇",items:e.bonusTypeItems},model:{value:e.formData.bonusType,callback:function(t){e.$set(e.formData,"bonusType",t)},expression:"formData.bonusType"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md4:""}},[a("v-text-field",{attrs:{label:"聯保",value:e.client2,readonly:""},on:{click:function(t){return t.stopPropagation(),e.showDialog(t)}}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md2:""}},[a("v-text-field",{attrs:{label:"基本計劃LOADING"},model:{value:e.formData.basePlan,callback:function(t){e.$set(e.formData,"basePlan",e._n(t))},expression:"formData.basePlan"}})],1),e._v(" "),a("v-flex",{attrs:{xs12:"",md2:""}},[a("v-text-field",{attrs:{label:"WP/PB FACTOR"},model:{value:e.formData.wppb,callback:function(t){e.$set(e.formData,"wppb",e._n(t))},expression:"formData.wppb"}})],1)],1)],1),e._v(" "),a("v-dialog",{attrs:{persistent:"","max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("add-info-client",{ref:"client2",staticClass:"greenClient",attrs:{title:"次擬被保人",info:e.client2Info,"client-disabled":e.clientDisabled,actions:""},on:{cancel:e.cancelHandler,confirm:e.confirmHandler}})],1)],1)},ae=[],ne=a("bc3a"),re=a.n(ne),se={name:"ProposalAddPlanForm",components:{AddInfoClient:J},mixins:[T["validationMixin"]],data:function(){return{formData:{plan:"",year:"",money:"",planName:"",yearName:"",payType:"",bonusType:"",basePlan:"0.0000",wppb:"1.0"},quotDetail:{},clientDisabled:!1,planItems:[],yearItems:[],moneyItems:[],payTypeItems:[],bonusTypeItems:[{text:"A-積存升息",value:1}],dialog:!1,isDisable:!1}},validations:{formData:{plan:{required:R["required"]},year:{required:R["required"]},money:{required:R["required"]}}},computed:Object(s["a"])({},Object(c["c"])({currentStep:function(e){return e.proposal.currentStep},salesInfo:function(e){return e.proposal.salesInfo},client1Info:function(e){return e.proposal.client1Info},client2Info:function(e){return e.proposal.client2Info},plan:function(e){return e.proposal.plan}}),{client2:function(){var e=this.client2Info,t=e.name,a=e.age,n=e.gender,r=e.isSmoker;if(!t)return"";var s=O(n),i=A(r);return"".concat(t,"，").concat(a,"歲，").concat(s,"，").concat(i)},planErrors:function(){var e=this.$v.formData.plan;return e.$dirty?e.required?"":"請選擇基本計劃":""},yearErrors:function(){var e=this.$v.formData.year;return e.$dirty?e.required?"":"請選擇年期":""},moneyErrors:function(){var e=this.$v.formData.money;return e.$dirty?e.required?"":"請選擇貨幣":""}}),watch:{currentStep:function(e){var t=this;2===e&&re.a.all([this.getProdList(),this.getPlanDetail()]).then(function(){t.formData.plan||setTimeout(function(){return t.$refs.planSelect.onClick()},450)})}},methods:{confirmHandler:function(){this.$refs.client2.getData()},cancelHandler:function(){this.$refs.client2.reset(),this.dialog=!1},getProdList:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.prodCovLineList({gender:O(this.client1Info.gender),age:this.client1Info.age});case 2:t=e.sent,this.planItems=t.body.prodList;case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),updOtherSelect:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.yearItems=[],this.moneyItems=[],this.payTypeItems=[],this.getYearItem(t,1);case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getYearItem:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t,a){var n,r,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=O(this.client1Info.gender),e.next=3,this.$api.productList({productLine:t,gender:n,age:this.client1Info.age});case 3:r=e.sent,this.yearItems=r.body.tabList,1===a&&(this.formData.year=this.yearItems[0].value,this.formData.yearName=this.yearItems[0].text,this.getMoneyItem(this.yearItems[0].value,1),this.getPayItem(this.yearItems[0].value,1),this.formData.bonusType=this.bonusTypeItems[0].value),this.yearItems.find(function(e){return""===e.text})?(this.isDisable=!0,this.formData.year=this.yearItems[0].value,this.formData.yearName=""):this.isDisable=!1,this.planItems.length>0&&(this.formData.planName=this.planItems.find(function(e){return e.value===s.formData.plan})["text"],this.formData.yearName=this.yearItems.find(function(e){return e.value===s.formData.year})["text"]);case 8:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}(),getMoneyItem:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t,a){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.countryCcyList({covCode:t});case 2:n=e.sent,this.moneyItems=n.body.ccyList,1===a&&(this.formData.money=this.moneyItems[0].value);case 5:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}(),getPayItem:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t,a){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.payModeList({covCode:t});case 2:n=e.sent,this.payTypeItems=n.body.modeList,1===a&&(this.formData.payType=this.payTypeItems[0].value);case 5:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}(),updYearSelect:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var a,n,r,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t,this.formData.yearName=this.yearItems.find(function(e){return e.value===s.formData.year})["text"],e.next=4,this.$api.countryCcyList({covCode:a});case 4:return n=e.sent,this.moneyItems=n.body.ccyList,e.next=8,this.$api.payModeList({covCode:a});case 8:r=e.sent,this.payTypeItems=r.body.modeList;case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getData:function(){var e=this.$v;if(e.$touch(),!e.$error)return Object(s["a"])({},this.formData)},getPlanDetail:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.showquotdetail({quotNo:this.salesInfo.proposalId});case 2:t=e.sent,t&&(this.quotDetail=t.body.quotDetail,null!==this.quotDetail.quotPlan&&(this.getYearItem(this.quotDetail.quotPlan),this.getMoneyItem(this.quotDetail.quotYears),this.getPayItem(this.quotDetail.quotYears),this.formData.plan=this.quotDetail.quotPlan,this.formData.year=this.quotDetail.quotYears,this.formData.money=this.quotDetail.quotCcy,this.formData.payType=this.quotDetail.quotPaymode,this.formData.bonusType=this.bonusTypeItems[0].value,this.formData.basePlan=this.quotDetail.quotLoading.toFixed(4),this.formData.wppb=this.quotDetail.quotFactor.toFixed(1)));case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),showDialog:function(){this.dialog=!0,this.dialog&&(this.clientDisabled=!0)}}},ie=se,oe=(a("b998"),a("169a")),le=a("b56d"),ue=Object(g["a"])(ie,te,ae,!1,null,null,null),ce=ue.exports;P()(ue,{VContainer:D["a"],VDialog:oe["a"],VFlex:I["a"],VForm:w["a"],VLayout:_["a"],VSelect:le["a"],VTextField:k["a"]});var de={name:"ProposalAddPlan",components:{AddInfoSales:C,AddPlanForm:ce},data:function(){return{}},computed:Object(s["a"])({},Object(c["c"])({currentStep:function(e){return e.proposal.currentStep},salesInfo:function(e){return e.proposal.salesInfo},client1Info:function(e){return e.proposal.client1Info},client2Info:function(e){return e.proposal.client2Info},plan:function(e){return e.proposal.plan}}),{client1:function(){var e=this.client1Info,t=e.name,a=e.age,n=e.gender,r=e.isSmoker;if(!t)return"";var s=O(n),i=A(r);return"".concat(t,"，").concat(a,"歲，").concat(s,"，").concat(i)}}),watch:{currentStep:function(e){2===e&&void 0!==this.quotNo&&this.getDetail()}},created:function(){this.quotNo=this.$route.query.quotNo},methods:Object(s["a"])({},Object(c["b"])(["proposal/SET_PLAN"]),{pre:function(){console.log("上一步"),this.$emit("pre")},next:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s,i,o,l,u,c,d,m,p,f,h;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$refs.planForm.getData(),a=t.year,n=t.money,r=t.payType,s=t.bonusType,i=t.basePlan,o=t.wppb,l=this.client1Info,u=l.age,c=l.gender,d=l.isSmoker,m=void 0!==this.client2Info?"Y":"",p=this.salesInfo.proposalId,f={quotFinsuredAge:u,quotFinsuredGender:c,quotFinsuredSmoker:d,quotNo:p,quotPlan:t.plan,quotYears:a,quotCcy:n,quotPaymode:r,quotDividend:s,quotJointLife:m,quotLoading:i,quotFactor:o},t){e.next=8;break}return e.abrupt("return",console.warn("表單數據未填寫"));case 8:return e.next=10,this.$api.insert(f);case 10:h=e.sent,console.log(h),this["proposal/SET_PLAN"](t),this.$emit("next");case 14:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getDetail:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.showquotdetail({quotNo:this.$route.query.quotNo});case 2:t=e.sent,a=t.body.quotDetail,n=a.quotFinsuredGender,n="F"===n?"女":"男",r=a.quotFinsuredSmoker,r="N"===r?"非吸煙者":"吸煙者",this.$refs.planForm.updOtherSelect(a.quotYears);case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()})},me=de,pe=a("ce7e"),fe=Object(g["a"])(me,Z,ee,!1,null,"5fd13090",null),he=fe.exports;P()(fe,{VBtn:L["a"],VContainer:D["a"],VDivider:pe["a"],VFlex:I["a"],VIcon:Y["a"],VLayout:_["a"],VTextField:k["a"]});var ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("add-info-sales",{ref:"infoSales",attrs:{info:e.salesInfo,disabled:""}}),e._v(" "),a("v-container",{staticClass:"py-0 px-3",attrs:{fluid:""}},[a("v-layout",[a("v-flex",{attrs:{xs12:"",md4:""}},[a("v-text-field",{attrs:{value:e.client1,label:"擬被保人",disabled:""}})],1)],1)],1),e._v(" "),a("v-container",{staticClass:"my-2",attrs:{fluid:""}},[a("v-layout",e._l(e.headers,function(t,n){return a("v-flex",{key:n,class:e.widths[n]},[a("strong",[e._v(e._s(t))])])}),1),e._v(" "),a("v-divider"),e._v(" "),a("v-layout",{staticClass:"py-2 lighten-3",attrs:{"align-center":""}},[a("v-flex",{staticClass:"xs12 md2 offset-md1"},[a("v-checkbox",{staticClass:"mt-0 pt-0",attrs:{label:"基本計劃","input-value":"true",disabled:"",primary:"","hide-details":""}})],1),e._v(" "),a("v-flex",{staticClass:"xs12 md3 mr-5"},[""==e.plan.yearName?a("span",{staticClass:"subheading"},[e._v(e._s(e.planName))]):a("span",{staticClass:"subheading"},[e._v(e._s(e.planName+"-"+e.plan.yearName))])]),e._v(" "),a("v-flex",{staticClass:"xs12 md1"},[a("v-checkbox",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"mt-0 pt-0 freeColor",attrs:{disabled:e.previewed,primary:"","hide-details":""},on:{change:function(t){return e.changeRemit(e.basePlan.free)}},model:{value:e.basePlan.free,callback:function(t){e.$set(e.basePlan,"free",t)},expression:"basePlan.free"}})],1),e._v(" "),a("v-flex",{staticClass:"xs12 md1 mr-5"},[e.basisInput?a("v-text-field",{staticClass:"text_fr",attrs:{disabled:e.previewed,maxlength:"10",solo:"","hide-details":""},on:{input:e.inputChange,blur:e.baseBlur,focus:function(t){return e.baseFocus(t)}},model:{value:e.basePlan.inputPremium,callback:function(t){e.$set(e.basePlan,"inputPremium",e._n(t))},expression:"basePlan.inputPremium"}}):e._e()],1),e._v(" "),a("v-flex",{staticClass:"xs12 md1"},[a("v-text-field",{staticClass:"text_fr",attrs:{disabled:!0,solo:"","hide-details":""},model:{value:e.basePlan.premium,callback:function(t){e.$set(e.basePlan,"premium",e._n(t))},expression:"basePlan.premium"}})],1)],1),e._v(" "),e._l(e.addPlan,function(t,n){return a("v-layout",{key:"tr-"+n,staticClass:"py-1",class:n%2==0&&"grey lighten-3",attrs:{"align-center":""}},[a("v-flex",{staticClass:"xs12 md2 offset-md1"},[a("v-checkbox",{staticClass:"mt-0 pt-0 baseColor",attrs:{label:t.type,disabled:t.isDisabled||e.previewed,primary:"","hide-details":""},on:{change:function(t){return e.isChecked(e.addPlan[n])}},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"addPlanItem.selected"}})],1),e._v(" "),a("v-flex",{staticClass:"xs12 md3 mr-5"},[a("v-select",{attrs:{items:t.options,disabled:!t.selected||!t.isRemitDisabled||e.previewed,"hide-details":"","return-object":""},on:{change:function(t){return e.isSelected(e.addPlan[n])}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"addPlanItem.value"}})],1),e._v(" "),a("v-flex",{staticClass:"xs12 md1"},["LTR"===t.key?a("v-checkbox",{staticClass:"mt-0 pt-0",attrs:{disabled:!0,primary:"","hide-details":""},model:{value:e.basisChecked,callback:function(t){e.basisChecked=t},expression:"basisChecked"}}):e._e()],1),e._v(" "),a("v-flex",{staticClass:"xs12 md1 mr-5"},["Y"==t.showSumInsured?a("v-text-field",{staticClass:"text_fr",attrs:{maxlength:"10",disabled:!t.selected||e.previewed,solo:"","hide-details":""},on:{input:e.inputChange,blur:e.planBlur,focus:function(t){return e.planFocus(t)}},model:{value:t.inputPremium,callback:function(a){e.$set(t,"inputPremium",e._n(a))},expression:"addPlanItem.inputPremium"}}):e._e()],1),e._v(" "),a("v-flex",{staticClass:"xs12 md1"},[a("v-text-field",{staticClass:"text_fr",attrs:{disabled:!0,solo:"","hide-details":""},model:{value:t.sumPremium,callback:function(a){e.$set(t,"sumPremium",e._n(a))},expression:"addPlanItem.sumPremium"}})],1)],1)}),e._v(" "),a("v-divider",{staticClass:"my-2"}),e._v(" "),a("v-layout",{attrs:{row:"",wrap:"","align-center":""}},[a("v-spacer"),e._v(" "),a("h3",[e._v("總保費：")]),e._v(" "),a("v-flex",{attrs:{md1:"","d-flex":""}},[a("v-text-field",{staticClass:"text_fr",attrs:{value:e.summation.premiums,disabled:!0,solo:"","hide-details":""}})],1)],1),e._v(" "),a("v-layout",{attrs:{row:"",wrap:"","align-center":"","mt-2":""}},[a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.previewed,expression:"!previewed"}],staticStyle:{background:"#52a5b5",color:"#fff"},on:{click:function(t){return e.pre()}}},[a("v-icon",[e._v("arrow_back")]),e._v("上一步\n      ")],1),e._v(" "),a("v-spacer"),e._v(" "),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.previewed,expression:"previewed"}],staticClass:"blueColor",on:{click:e.add}},[a("v-icon",{staticClass:"mr-1"},[e._v("add")]),e._v("新增\n      ")],1),e._v(" "),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.previewed,expression:"previewed"}],staticClass:"blueColor",on:{click:e.edit}},[a("v-icon",{staticClass:"mr-1"},[e._v("edit")]),e._v("修改\n      ")],1),e._v(" "),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.isPrint,expression:"isPrint"}],staticClass:"printColor",on:{click:e.printf}},[a("v-icon",{staticClass:"mr-1"},[e._v("print")]),e._v("預覽（PDF）\n      ")],1),e._v(" "),a("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.previewed,expression:"!previewed"}],staticStyle:{background:"#52a5b5",color:"#fff"},on:{click:e.sum}},[a("v-icon",{staticClass:"mr-1"},[e._v("monetization_on")]),e._v("計算\n      ")],1),e._v(" "),a("h3",[e._v("每年總保費：")]),e._v(" "),a("v-flex",{attrs:{md1:"","d-flex":""}},[a("v-text-field",{staticClass:"text_fr",attrs:{value:e.summation.premiumsPerYear,disabled:!0,solo:"","hide-details":""}})],1)],1),e._v(" "),a("add-detail-dialog",{attrs:{show:e.showDialog,message:e.message},on:{"update:show":function(t){e.showDialog=t}}}),e._v(" "),e.overlay?a("div",[a("div",{staticClass:"bgLoad"},[a("div",{staticClass:"loading"},[a("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1)])]):e._e()],2)],1)},be=[],ye=(a("ac4d"),a("8a81"),a("ac6a"),a("20d6"),a("75fc")),ge=a("4979"),xe=a.n(ge),Pe=a("3439"),De=a("e7cc"),Ie={name:"ProposalAddDetail",components:{AddDetailDialog:De["a"],AddInfoSales:C},props:{step:{type:Number,default:0}},data:function(){return{overlay:!0,showDialog:!1,isPrint:!1,isShow:!0,basisChecked:!1,basisInput:!0,isRemit:[],isBasis:{},isBasisLtr:{},message:[],widths:["xs12 md2 offset-md1","xs12 md3 mr-5","xs12 md1","xs12 md1 mr-5","xs12 md2"],basePlan:{free:!1,inputPremium:"0",premium:"0.00"},addPlan:[],summation:{premiums:"0.00",premiumsPerYear:"0.00"},valiteParam:[],baseData:{},planArr:[],planData:{},sumMoney:0}},inject:["reload"],computed:Object(s["a"])({},Object(c["c"])({currentStep:function(e){return e.proposal.currentStep},salesInfo:function(e){return e.proposal.salesInfo},client1Info:function(e){return e.proposal.client1Info},client2Info:function(e){return e.proposal.client2Info},client3Info:function(e){return e.proposal.client3Info},plan:function(e){return e.proposal.plan},previewed:function(e){return e.proposal.previewed}}),{headers:function(){var e=this.plan.money;return["保障類型","計劃名稱","豁免保費","保額（".concat(e,"）"),"年繳保費（".concat(e,"）")]},client1:function(){var e=this.client1Info,t=e.name,a=e.age,n=e.gender,r=e.isSmoker;if(!t)return"";var s=O(n),i=A(r);return"".concat(t,"，").concat(a,"歲，").concat(s,"，").concat(i)},planName:function(){var e=this.plan.planName,t=p(e);return"".concat(t)}}),watch:{currentStep:function(e){3===e&&(this.getItems(),this.getDetail(),this.plan.year!==this.baseData.covCode&&(this.basePlan.inputPremium="0",this.clearPremium(),this.basePlan.free=!1,this.basisChecked=!1))}},created:function(){var e=this;3===this.currentStep&&re.a.all([this.getItems(),this.getDetail()]).then(function(t){e.$router.query.detail&&e.sum()})},methods:Object(s["a"])({},Object(c["b"])(["proposal/UPDATE_STEP","proposal/UPDATE_PREVIEWED","proposal/RESET_STATE"]),{pre:function(){this.$emit("pre")},edit:function(){this["proposal/UPDATE_STEP"](1)},add:function(){this.$router.push({name:"ProposalAdd",params:{}}),this["proposal/UPDATE_STEP"](1),this.reload()},getItems:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s,i,o,l,u,c,d,m,p,f,h,v;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.plan,a=t.money,n=t.plan,r=t.basePlan,s=t.wppb,i=t.year,o=this.salesInfo.proposalId,l=this.client1Info.age,u=this.client2Info.age,c=this.client3Info.age,e.next=7,this.$api.getAdditionalInsurance({quplanNo:o,ccy:a,basePlan:r,wppb:s,covCodeDisp:n,covCode:i,age:l,subAge:u,payerAge:c});case 7:if(d=e.sent,this.overlay=!d,m=d.body,p=this.formatData(m),d.hmflag?(this.isShow=!0,this.isRemit=p.pop(),this.isRemit.selected=!0,this.isRemit.isDisabled=!0,this.isRemit.value=this.isRemit.options[0]):this.isShow=!1,"N"===d.sumInd?this.basisInput=!1:this.basisInput=!0,this.basePlan.free&&p.push(this.isRemit),this.addPlan=Object(ye["a"])(p),f=this.addPlan.findIndex(function(e){return"LTR-T"===e.key}),-1!==f&&(this.isBasis=this.addPlan.splice(f,1)[0]),this.isBasisLtr=this.addPlan.filter(function(e){return"LTR"===e.key})[0],this.isBasis.selected=!0,this.isBasis.isDisabled=!0,this.isBasis.isRemitDisabled=!1,!this.basisChecked){e.next=30;break}return e.next=24,this.$api.getRemitList({covCode:i,covCodeDEDQ:this.isBasisLtr.value.value});case 24:h=e.sent,v=h.body[0],this.isBasis.value={text:v.classNameOth,value:v.covClass},this.addPlan.push(this.isBasis),e.next=31;break;case 30:this.isBasis.options&&(this.isBasis.value=this.isBasis.options[0]);case 31:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),formatData:function(e){var t=[];for(var a in e){var n=e[a];if(Array.isArray(n)&&n.length){var r=this.plan.money,s=Number(this.plan.basePlan),i=Number(this.plan.wppb),o=this.client1Info,l=o.gender,u=o.isSmoker,c=o.age,m=n.map(function(e){var t=e.classNameOth,a=e.covClass;return{text:t,value:a}}),p=n[0].covCode,f=n[0].covClass,h=n[0].defaultval,v=n[0].covNameOth,b=n[0].showSumInsured,y=n[0].covTermRiderInd,g=n.find(function(e){return e.selected}),x={key:a,covCode:p,basePlan:s,wppb:i,covClass:f,type:v,showSumInsured:b,covTermRiderInd:y,options:m,selected:!1,isDisabled:!1,isRemitDisabled:!0,value:"",inputPremium:0,sumPremium:0,sex:l,smoke:u,ccy:r,issAge:c,defaultval:h};x.sumPremium=x.sumPremium.toFixed(2),g&&(x.value={value:g.covClass,text:g.classNameOth},x.selected=!0,x.inputPremium=g.inputPremium,x.sumPremium=d(String(g.sumPremium)),"W"===g.showSumInsured&&(this.basePlan.free=!0),"F"===g.showSumInsured&&(this.basisChecked=!0,this.isBasis.value={value:g.covClass,text:g.classNameOth})),t.push(x)}}return t},changeRemit:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var a,n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.clearPremium(),!t){e.next=15;break}if(this.addPlan.push(this.isRemit),a=this.plan.year,!this.isBasisLtr){e.next=13;break}if(!this.isBasisLtr.selected){e.next=13;break}return e.next=8,this.$api.getRemitList({covCode:a,covCodeDEDQ:this.isBasisLtr.value.value});case 8:n=e.sent,r=n.body[0],this.isBasis.value={text:r.classNameOth,value:r.covClass},this.basisChecked=!0,this.addPlan.push(this.isBasis);case 13:e.next=16;break;case 15:this.basisChecked?(this.basisChecked=!1,this.addPlan.splice(this.addPlan.findIndex(function(e){return"*"===e.covClass&&"W"===e.showSumInsured}),1),this.addPlan.splice(this.addPlan.findIndex(function(e){return"LTR-T"===e.key}),1)):this.addPlan.pop();case 16:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),baseFocus:function(e){e.currentTarget.select()},baseBlur:function(){-1===String(this.basePlan.inputPremium).indexOf(",")&&(this.basePlan.inputPremium=m(this.basePlan.inputPremium))},planFocus:function(e){e.currentTarget.select()},planBlur:function(){this.addPlan.forEach(function(e){-1===String(e.inputPremium).indexOf(",")&&(e.inputPremium=m(e.inputPremium))})},isChecked:function(e){this.clearPremium(),!1===e.selected?(e.inputPremium=0,e.sumPremium="0.00",e.value=""):e.value=e.options[0],this.basePlan.free&&"LTR"===e.key&&(e.selected?(this.basisChecked=!0,this.addPlan.push(this.isBasis)):(this.basisChecked=!1,this.addPlan.splice(this.addPlan.findIndex(function(e){return"LTR-T"===e.key}),1)[0]))},isSelected:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var a,n,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.clearPremium(),a=this.plan.year,"LTR"!==t.key){e.next=9;break}return n=t.value.value,e.next=6,this.$api.getRemitList({covCode:a,covCodeDEDQ:n});case 6:r=e.sent,s=r.body[0],this.isBasis.value={text:s.classNameOth,value:s.covClass};case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),inputChange:function(){this.clearPremium()},clearPremium:function(){this.isPrint=!1,this.planArr.forEach(function(e){e.sumPremium="0.00"}),this.summation.premiumsPerYear=this.summation.premiums=this.basePlan.premium="0.00"},valite:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s,i,o,l,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.plan,a=t.plan,n=t.money,r=t.planName,s=this.addPlan.filter(function(e){return e.selected}),i={planDesc:p(r),plan:a,ccy:n,amount:Number(this.basePlan.inputPremium.replace(/,/g,""))},this.valiteParam.push(i),s.length>0)for(o=0;o<s.length;o++)l={},l.planDesc=s[o].type+" - "+s[o].value.text,l.plan=s[o].key,l.ccy=s[o].ccy,"0"===s[o].inputPremium&&(l.amount=0),-1!==String(s[o].inputPremium).indexOf(",")?l.amount=Number(s[o].inputPremium.replace(/,/g,"")):l.amount=Number(s[o].inputPremium),this.valiteParam.push(l);return e.next=7,this.$api.insuredamount(this.valiteParam);case 7:u=e.sent,this.valiteParam=[],1e3===u.responseCode?(this.isPrint=!0,this.showDialog=!1,this.sum()):u.body.desc.length>0&&(this.message=u.body.desc);case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),sum:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s,i,o,l,u,c,f,h,v,b,y,g,x,P,D,I,w,_,k;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.isPrint){e.next=47;break}for(v in t=this.plan,a=t.year,n=t.plan,r=t.money,s=t.planName,i=Number(this.plan.basePlan),o=Number(this.plan.wppb),l=this.client1Info,u=l.gender,c=l.isSmoker,f=l.age,this.baseData={inputPremium:Number(this.basePlan.inputPremium.replace(/,/g,"")),basePlan:i,wppb:o,covCode:a,type:"基本计划",value:{text:s,value:n},planCode:n,sex:u,smoke:c,ccy:r,issAge:f,covClass:"*",showSumInsured:"Y",defaultval:"",covTermRiderInd:"N"},this.isRemit.inputPremium=this.baseData.inputPremium,h=xe()(this.planArr),h=this.addPlan.filter(function(e){return e.selected}),h)h[v].ccy=r,h[v].covClass=h[v].value.value,"LTR-T"===h[v].key&&(b=h.find(function(e){return"LTR"===e.key}).inputPremium,h[v].inputPremium=b),-1!==String(h[v].sumPremium).indexOf(",",0)&&(h[v].sumPremium=Number(h[v].sumPremium.replace(/,/g,""))),-1!==String(h[v].inputPremium).indexOf(",",0)&&(h[v].inputPremium=Number(h[v].inputPremium.replace(/,/g,"")));return h.unshift(this.baseData),e.next=13,this.$api.getSumPremium(h);case 13:if(y=e.sent,h.shift(this.baseData),g=d(String(y.body[0].sumPremium)),this.basePlan.premium=g,x=y.body.slice(1,y.body.length),P=function(e,t,a,n){var r={},s=!0,i=!1,o=void 0;try{for(var l,u=t[Symbol.iterator]();!(s=(l=u.next()).done);s=!0){var c=l.value;r[c[a]]=c[n]}}catch(d){i=!0,o=d}finally{try{s||null==u.return||u.return()}finally{if(i)throw o}}e.map(function(e){e[n]=r[e[a]]})},P(this.addPlan,x,"covCode","sumPremium"),this.planArr=Object(ye["a"])(h),this.addPlan.forEach(function(e){-1===String(e.inputPremium).indexOf(",")&&(e.inputPremium=m(e.inputPremium)),void 0===e.sumPremium?e.sumPremium="0.00":e.sumPremium=d(String(e.sumPremium))}),this.sumMoney=x.reduce(function(e,t){return e+t.sumPremium},0),this.sumMoney=Number(this.sumMoney)+y.body[0].sumPremium,this.summation.premiumsPerYear=this.summation.premiums=d(this.sumMoney.toFixed(2)),!y||1e3!==y.responseCode){e.next=45;break}return e.next=28,this.$api.premiumamount({mode:"A",ccy:r,amount:this.sumMoney,code:a});case 28:if(D=e.sent,1e3!==D.responseCode){e.next=41;break}if(this.isPrint=!0,I=this.salesInfo.proposalId,this.planData={quotNo:I,quotPlanCode:y.body[0].value.value,quotPlanCodeDesc:y.body[0].value.text,quotTotalPrem:this.sumMoney,quotTotalPremAnn:this.sumMoney,quotplanList:[{quplanRiderCode:a,quplanRiderCodeDesc:y.body[0].value.text,quplanRiderClass:a,quplanRiderClassDesc:y.body[0].value.text,quplanSumInsured:Number(this.basePlan.inputPremium.replace(/,/g,"")),quplanAnnPremium:y.body[0].sumPremium,quplanTermRiderIndex:"Y"}]},!0===this.basePlan.free?this.planData.quotPlanWaiver="Y":this.planData.quotPlanWaiver="",this.planArr.length>0)for(w=0;w<x.length;w++)_={},_.quplanRiderCode=x[w].key,_.quplanRiderCodeDesc=x[w].type,_.quplanRiderClass=x[w].value.value,_.quplanRiderClassDesc=x[w].value.text,"W"===x[w].showSumInsured||"F"===x[w].showSumInsured?_.quplanSumInsured=0:_.quplanSumInsured=x[w].inputPremium,_.quplanAnnPremium=x[w].sumPremium,_.quplanTermRiderIndex=x[w].covTermRiderInd,this.planData.quotplanList.push(_);return e.next=37,this.$api.insertPlan(this.planData);case 37:k=e.sent,console.log(k),e.next=45;break;case 41:this.isPrint=!1,this.showDialog=!0,this.message=[],1064===D.responseCode?this.message[0]=p(s)+"- 年繳保費少於"+r+"$"+D.body.amount.toLocaleString()+" 限額！":1065===D.responseCode&&(this.message[0]=p(s)+"- 年繳保費大於"+r+"$"+D.body.amount.toLocaleString()+" 限額！");case 45:e.next=49;break;case 47:this.showDialog=!0,this.valite();case 49:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),printf:function(){var e=this;this.overlay=!0,re.a.post(Pe["baseUrl"].dev+"/mailMerge/proposalDownload.json",{quotNo:this.salesInfo.proposalId},{responseType:"blob"}).then(function(t){if(e.overlay=!1,200===t.status){e["proposal/UPDATE_PREVIEWED"](!0);var a=document.createElement("a"),n=new Blob([t.data],{type:"application/pdf;charset-UTF-8"});a.setAttribute("download","聯豐亨人壽保險計劃建議書"),a.href=window.URL.createObjectURL(n),document.body.appendChild(a),a.click()}})},getDetail:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.showquotdetail({quotNo:this.salesInfo.proposalId});case 2:t=e.sent,t.body.planList.length>0?(this.basePlan.inputPremium=m(t.body.planList[0].quplanSumInsured),this.basePlan.premium=d(String(t.body.planList[0].quplanAnnPremium)),this.sumMoney=t.body.planList.reduce(function(e,t){return e+t.quplanAnnPremium},0),this.summation.premiumsPerYear=this.summation.premiums=d(this.sumMoney.toFixed(2)),re.a.all([this.getItems()]).then(function(e){a.basisChecked&&a.addPlan.splice(a.addPlan.findIndex(function(e){return"LTR-T"===e.key}),1)[0],a.sum(),a.isPrint=!0})):(this.basePlan.free=!1,this.basisChecked=!1,void 0!==this.addPlan.find(function(e){return"LTR-T"===e.key})&&this.addPlan.splice(this.addPlan.findIndex(function(e){return"*"===e.covClass&&"W"===e.showSumInsured}),1),this.clearPremium(),this.basePlan.inputPremium="0",this.isPrint=!1);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()})},we=Ie,_e=(a("7063"),a("ac7c")),ke=a("490a"),Se=Object(g["a"])(we,ve,be,!1,null,null,null),Ce=Se.exports;P()(Se,{VBtn:L["a"],VCheckbox:_e["a"],VContainer:D["a"],VDivider:pe["a"],VFlex:I["a"],VIcon:Y["a"],VLayout:_["a"],VProgressCircular:ke["a"],VSelect:le["a"],VSpacer:G["a"],VTextField:k["a"]});var qe={name:"",data:function(){return{steps:["客戶資料","保險計劃","計劃詳情"],components:[X,he,Ce]}},computed:Object(s["a"])({},Object(c["c"])({currentStep:function(e){return e.proposal.currentStep},previewed:function(e){return e.proposal.previewed}})),beforeDestroy:function(){this.updateStep(1),this["proposal/RESET_STATE"]()},methods:Object(s["a"])({},Object(c["b"])(["proposal/UPDATE_STEP","proposal/RESET_STATE"]),{updateStep:function(e){this["proposal/UPDATE_STEP"](e)},preHandler:function(e){this["proposal/UPDATE_STEP"](this.currentStep-1)},nextHandler:function(e){e===this.components.length?console.log("要計算了"):this["proposal/UPDATE_STEP"](this.currentStep+1)}})},$e=qe,Te=(a("da53"),a("7e85")),Re=a("e516"),Ne=a("9c54"),Oe=a("56a4"),Ee=Object(g["a"])($e,n,r,!1,null,null,null);t["default"]=Ee.exports;P()(Ee,{VDivider:pe["a"],VStepper:Te["a"],VStepperContent:Re["a"],VStepperHeader:Ne["a"],VStepperItems:Ne["b"],VStepperStep:Oe["a"]})},"0fb7":function(e,t,a){"use strict";var n=a("6e06"),r=a.n(n);r.a},"424c":function(e,t,a){},"62f0":function(e,t,a){},"6e06":function(e,t,a){},7063:function(e,t,a){"use strict";var n=a("424c"),r=a.n(n);r.a},b998:function(e,t,a){"use strict";var n=a("62f0"),r=a.n(n);r.a},da53:function(e,t,a){"use strict";var n=a("09fc"),r=a.n(n);r.a},e7cc:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{width:"700"},model:{value:e.dialogShow,callback:function(t){e.dialogShow=t},expression:"dialogShow"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("\n      錯誤\n    ")]),e._v(" "),a("v-divider"),e._v(" "),a("v-card-text",[e._l(e.errorMessage,function(t,n){return a("p",{key:n,staticClass:"error--text"},[a("v-icon",{attrs:{color:"error"}},[e._v("error")]),e._v(e._s(t))],1)}),e._v(" "),e.loginMessage?a("p",{staticClass:"error--text"},[a("v-icon",{attrs:{color:"error"}},[e._v("error")]),e._v(e._s(e.loginMessage))],1):e._e()],2),e._v(" "),a("v-divider"),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(t){e.dialogShow=!1}}},[e._v("\n        确定\n      ")])],1)],1)],1)},r=[],s={name:"ProposalAddDetailDialog",props:{show:{type:Boolean,default:!1},message:{type:Array,default:function(){return[]}},loginMessage:{type:String,default:""}},data:function(){return{dialogShow:this.show,errorMessage:[]}},computed:{},watch:{show:function(e){this.dialogShow=e},message:function(e){this.errorMessage=e},loginMessage:function(e){this.loginMessage=e},dialogShow:function(e){this.$emit("update:show",e)}},created:function(){},methods:{}},i=s,o=a("2877"),l=a("6544"),u=a.n(l),c=a("8336"),d=a("b0af"),m=a("99d9"),p=a("12b2"),f=a("169a"),h=a("ce7e"),v=a("132d"),b=a("9910"),y=Object(o["a"])(i,n,r,!1,null,"197b123d",null);t["a"]=y.exports;u()(y,{VBtn:c["a"],VCard:d["a"],VCardActions:m["a"],VCardText:m["b"],VCardTitle:p["a"],VDialog:f["a"],VDivider:h["a"],VIcon:v["a"],VSpacer:b["a"]})}}]);